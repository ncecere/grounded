2026-01-21 - Documented runtime entrypoints/startup sequences for API, web, ingestion worker, and scraper worker in phase-0 baseline; added baseline doc test coverage.
2026-01-21 - Documented environment variables and settings precedence per app in phase-0 baseline, including worker settings fetch; added baseline doc test coverage.
2026-01-21 - Documented ingestion pipeline flow with queues and ownership in phase-0 baseline; added baseline doc test coverage for pipeline flow.
2026-01-21 - Added queue name-to-payload/processor mapping in phase-0 baseline; extended baseline doc tests for queue contracts.
2026-01-21 - Documented API response and SSE contract baselines in phase-0 baseline; added baseline doc test coverage for contract section.
2026-01-21 - Documented observability baseline (wide event fields, error codes, metrics) and added doc test coverage.
2026-01-21 - Added API route inventory to phase-0 baseline and expanded baseline doc tests for route coverage.
2026-01-21 - Documented web app page inventory and navigation flows in phase-0 baseline; added baseline doc test coverage.
2026-01-21 - Added largest file hotspots and repeated patterns per app to phase-0 baseline; extended baseline doc tests.
2026-01-21 - Documented cross-cutting helpers (auth, audit, RLS, logging, settings) in phase-0 baseline; added baseline doc tests for helper inventory.
2026-01-21 - Mapped tenant boundary and RLS enforcement touchpoints in phase-0 baseline; added baseline doc tests for RLS section.
2026-01-21 - Added shared package inventory (shared/queue/logger/db) with consumers to phase-0 baseline; added baseline doc test coverage.
2026-01-21 - Documented startup environment/config dependencies in phase-0 baseline and extended baseline doc tests for config dependencies.
2026-01-21 - Documented external service dependencies (AI providers, vector store, SMTP, Firecrawl, uploads) in phase-0 baseline and added baseline doc test coverage.
2026-01-21 - Added baseline throughput snapshot for ingestion and scraper queues with config-based metrics; updated baseline doc tests.
2026-01-21 - Added critical workflow checklist for auth, chat SSE, ingestion, and scraping to phase-0 baseline; extended baseline doc tests.
2026-01-21 - Documented existing test commands and smoke checks in phase-0 baseline; added baseline doc test coverage for test/smoke section.
2026-01-21 - Added docs/refactor/test-matrix.md with app/workflow validation matrix and automated check coverage; added test-matrix doc test coverage.
2026-01-21 - Documented refactor constraints in phase-0 baseline and added baseline doc test coverage for the constraints section.
2026-01-21 - Documented phase dependencies/potential blockers in phase-0 baseline and added baseline doc test coverage.
2026-01-21 - Added `docs/refactor/baseline.md` index note with inventory coverage and supporting doc links; added baseline inventory doc tests.
2026-01-21 - Added `docs/refactor/dependencies.md` dependency map with package/service owners plus doc coverage tests.
2026-01-21 - Verified test matrix doc coverage and marked the phase-0 test matrix task complete.
2026-01-21 - Added migration log template in docs/refactor/migration-log.md and created doc coverage tests.
2026-01-21 - Defined API domain module boundaries and migration order in tasks/phase-1-api-structure.md with doc coverage tests.
2026-01-21 - Documented API module boundary rules/import directions in tasks/phase-1-api-structure.md; added doc coverage tests.
2026-01-21 - Defined API module template guidance in tasks/phase-1-api-structure.md and added doc test coverage for the template section.
2026-01-21 - Documented required exports and optional module layers in tasks/phase-1-api-structure.md and extended doc test coverage.
2026-01-21 - Added API app assembly module with createApiApp plus health check test coverage.
2026-01-21 - Added v1 routes index assembler with a regression test for auth callback route mounting.
2026-01-21 - Added API startup index for startup tasks/shutdown handling with tests covering startup flow and shutdown cleanup.
2026-01-21 - Documented API middleware order and route mount map in phase-1 plan; added doc test coverage.
2026-01-21 - Added API modules barrel export with re-exports and a regression test for module exports.
2026-01-21 - Documented API route aliases/shared routers in phase-1 plan and added doc test coverage.
2026-01-21 - Moved hosted chat page routes (redirect + published chat asset) into a dedicated module with route tests.
2026-01-21 - Extracted API route validation schemas into module-level schema files, updated routes/services/tests to import them, and verified API tests pass.
2026-01-21 - Moved admin audit enrichment queries into modules/admin/repo helpers with tests for empty-id shortcuts.
2026-01-21 - Added agent service layer, routed agent endpoints through services, and covered widget config merge behavior with service tests.
2026-01-21 - Documented service/repo transaction patterns in phase-1 API structure plan and added doc test coverage.
2026-01-21 - Normalized knowledge base error handling to BadRequestError for invalid embedding models and added route test coverage for reindex validation.
2026-01-21 - Centralized audit logging context creation in audit helpers, updated API routes to reuse it, and added coverage tests for the new helper.
2026-01-21 - Added SSE contract regression checks for chat/widget streams with event payload assertions and ordering coverage; verified chat integration tests.
2026-01-21 - Fixed API test imports after module refactoring: added missing bun:test import to chat service test, added ts-expect-error for Bun query string cache-busting in knowledge-bases test; created import-structure.test.ts to validate module schema imports and route structure; all 907 API tests pass.
2026-01-21 - Created docs/refactor/api-modules.md with comprehensive API module map covering: module structure overview, domain module inventory with layers (routes/schema/service/repo), import rules and cross-module access patterns, app assembly components, middleware order, route mount map (public/tenant/admin/internal), route aliases, and module exports; added api-modules-doc.test.ts with 14 tests validating doc structure and accuracy against actual code; all 921 API tests pass.
2026-01-21 - Defined ingestion worker folder layout in phase-2-ingestion-worker.md: documented bootstrap/, queues/, jobs/, stage/, and services/ folder structure; created file mapping from current processors/ to proposed jobs/ structure; mapped stage-manager.ts sections to stage/ modules; mapped stage-job-queuer.ts functions to stage/queue-*.ts files; documented module responsibilities and slim entrypoint example; added phase-2-ingestion-worker-doc.test.ts with 20 tests validating documentation structure and current codebase files.
2026-01-21 - Added ingestion worker bootstrap/helpers.ts with centralized logging and error handling: getWorkerLogger() singleton logger, ingestLog for inline logging, workerSamplingConfig for job sampling, IngestionError base class with error hierarchy (NotFoundError, ConfigurationError, ProcessingError, EmbeddingError, EmbeddingDimensionMismatchError, StageTransitionError), plus normalizeError/getErrorMessage/isRetriableError/withErrorLogging utilities; added 41 tests covering all error classes, utilities, and logging exports; all 61 ingestion worker tests pass.
