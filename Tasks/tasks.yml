project: grounded
version: "1.0"

tasks:
  # ===========================================================================
  # PARALLEL GROUP 1: Shared source logic
  # These tasks can run concurrently
  # ===========================================================================
  - title: Extract shared source CRUD + run helpers for sources and shared-kbs routes
    completed: true
    parallel_group: 1
    tags: [refactor, api, sources]
    notes: Consolidate validation, update merging, stats queries, and run creation into shared helpers.

  # ===========================================================================
  # PARALLEL GROUP 2: Widget chat consolidation
  # ===========================================================================
  - title: Unify widget /chat and /chat/stream handlers into a shared streaming function
    completed: true
    parallel_group: 2
    tags: [refactor, api, widget]

  # ===========================================================================
  # PARALLEL GROUP 3: Agent access helpers
  # ===========================================================================
  - title: Create reusable agent ownership loader for agents and tools routes
    completed: true
    parallel_group: 3
    tags: [refactor, api, agents]
    notes: Standardize tenant ownership checks and error handling.

  # ===========================================================================
  # PARALLEL GROUP 4: Knowledge base aggregation
  # ===========================================================================
  - title: Extract shared knowledge base aggregation utilities (counts, summaries)
    completed: true
    parallel_group: 4
    tags: [refactor, api, knowledge-bases]

  # ===========================================================================
  # PARALLEL GROUP 5: Auth middleware split
  # ===========================================================================
  - title: Split auth middleware into focused modules and re-export a unified middleware
    completed: true
    parallel_group: 5
    tags: [refactor, api, auth]
    notes: Separate bearer/JWT, API key, admin token, and OIDC handlers.

  # ===========================================================================
  # PARALLEL GROUP 6: Web API client modularization
  # ===========================================================================
  - title: Break up web API client into client/types/domain modules
    completed: true
    parallel_group: 6
    tags: [refactor, web, api-client]
    notes: Split request helpers, shared types, and domain endpoints into separate files.

  # ===========================================================================
  # PARALLEL GROUP 7: Tenant alert helpers
  # ===========================================================================
  - title: Move tenant alert validation/defaulting into a helper module
    completed: true
    parallel_group: 7
    tags: [refactor, api, tenants]

metadata:
  created_at: "2026-01-17"
  updated_at: "2026-01-17"
  owner: "unassigned"
  last_completed: "Move tenant alert validation/defaulting into a helper module"
